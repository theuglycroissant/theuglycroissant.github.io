let fuse,recipeData=[],tagData={},tags=[],searchParams={tags:[],term:""},searchKeys=["title","description"],recipeCards=Array.from(document.getElementsByClassName("recipe_card"));function parseURLQueries(){const e=new URLSearchParams(window.location.search);searchParams.tags=e.getAll("tag")}function displayTagData(){tagList="",tags.forEach(e=>{tagChecked=searchParams.tags.includes(e)?"checked":"",tagList+=`<div class="multicheck_row" multicheck-value="${e}">`,tagList+=`<input type="checkbox" name="multicheck_tags_${e}" ${tagChecked}>`,tagList+=`<label for="multicheck_tags_${e}">${e}</label>`,tagList+="</div>"}),document.getElementById("tagList").innerHTML=tagList}function tagChange(e,a){let t=searchParams.tags.indexOf(a);-1==t?searchParams.tags.push(a):searchParams.tags.splice(t,1),updateTagsTitle(),searchFilter()}function updateTagsTitle(){let e,a=document.getElementById("multicheck_title_tags"),t=searchParams.tags.length;e=0==t?"Tags":1==t?searchParams.tags[0]:2==t?`${searchParams.tags[0]}, ${searchParams.tags[1]}`:t+" selected",a.innerHTML=e}function setupSearchBox(){fuse=new Fuse(recipeData,{keys:searchKeys,distance:500}),document.getElementById("search_box").addEventListener("input",e=>{searchParams.term=e.target.value,searchFilter()})}function searchFilter(){let e=recipeData.map(e=>e.link),a=[];searchParams.term.length>0?searchResults=fuse.search(searchParams.term).map(e=>e.item):searchResults=recipeData;let t=0;searchResults.forEach(s=>{let r=!1;0==searchParams.tags.length?r=!0:searchParams.tags.forEach(e=>{r||-1!==s.tags.indexOf(e)&&(r=!0)}),r&&(index=e.indexOf(s.link),e.splice(index,1),a.push({link:s.link,order:t}),t+=1)}),e.forEach(e=>{hideCard(document.getElementById(e))}),a.forEach(e=>{card=document.getElementById(e.link),card.style.order=e.order,showCard(card)})}function showCard(e){e.classList.remove("hidden")}function hideCard(e){e.classList.add("hidden")}parseURLQueries(),fetch("/data/taglist.json").then(e=>e.json()).then(e=>{tags=e}).then(()=>{displayTagData(),setupListeners("tagList",tagChange),updateTagsTitle()}).catch(e=>console.log(e)),fetch("/data/directories/recipe.json").then(e=>e.json()).then(e=>{recipeData=e}).then(()=>{setupSearchBox(),searchFilter()}).catch(e=>console.log(e));